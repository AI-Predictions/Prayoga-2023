<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>AI Prediction Models</title>
        <link rel="stylesheet" href="style.css">
        <style>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap');</style>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">
        <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
        <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    </head>
    <body>
        <header>
            <a href="#" class="logo">AI Prediction</a>
            <div class="navigation">
                <div class="navigation-items">
                    <a href="index.html">Home</a>
                    <a href="#">About</a>
                </div>
            </div>
        </header> 
        <section class="home">
            <video class="video-slide" src="3.mp4" autoplay muted loop></video>
            <div class="content">
                <h1>Prediction.<br><span> Model</span></h1><br></h1>
                <py-config>
                    packages = ["matplotlib", "pandas","numpy","sklearn"]
                  </py-config>
                <py-script>
                    import pandas as pd
                    import numpy as np
                    from sklearn.model_selection import train_test_split
                    from sklearn.linear_model import LinearRegression
                    from sklearn.compose import ColumnTransformer
                    from sklearn.preprocessing import OneHotEncoder
                    from sklearn.metrics import mean_squared_error
                    from sklearn import metrics
                    import matplotlib.pyplot as plt
                    from sklearn.feature_selection import RFE
                    from sklearn.ensemble import RandomForestClassifier  
                    
                    # Load the dataset
                    data = pd.read_csv('train-data-3.csv') # Replace with your dataset file path
                    print(data)
                      
                    # Select relevant features and target variable
                    features = ['Year', 'Kilometers_Driven','Fuel_Type', 'transmission','owner','Price']#'Location', 'Year', 'Kilometers_Driven','Fuel_Type', 'Transmission', 'Owner_Type', 'Mileage', 'Engine', 'Power', 'Seats', 'car_company'
                    target = 'Price'
                    
                    X = data[features]
                    y = data[target]
                    
                    # Perform one-hot encoding for categorical variables
                    categorical_features = ['Year', 'Kilometers_Driven','Fuel_Type', 'transmission','owner','Price']
                    preprocessor = ColumnTransformer([('encoder', OneHotEncoder(), categorical_features)], remainder='passthrough')
                    X_encoded = preprocessor.fit_transform(X)
                    
                    # Split the data into training and testing sets
                    X_train, X_test, y_train, y_test = train_test_split(X_encoded, y, test_size = 0.1, random_state = 104)#104 = 76% 0.1 = 88% 0.3=80%
                    
                    # Initialize and train the linear regression model
                    model = LinearRegression()
                    model.fit(X_train, y_train)
                    
                    # Make predictions on the training set
                    train_predictions = model.predict(X_train)
                    
                    # Evaluate the model using mean squared error (MSE) on training set
                    train_mse = mean_squared_error(y_train, train_predictions)
                    print("Training MSE:", train_mse)
                    
                    # Make predictions on the testing set
                    predictions = model.predict(X_test)
                    plt.scatter(y_test, predictions)
                    # Evaluate the model using mean squared error (MSE) on testing set
                    test_mse = mean_squared_error(y_test, predictions)
                    print('Testing MSE: ', (metrics.mean_squared_error(y_test, predictions)))
                    acc = (model.score(X_test, y_test)*100)
                    print("Accuracy : ",round(acc),"%")
                </py-script>
            </div>
        </section>
    </body>
</html>
